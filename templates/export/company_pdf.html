<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>{{ company.name }} - Research Notes</title>
    <style>
        @page {
            size: letter;
            margin: 0.75in;
            @bottom-center {
                content: "Page " counter(page) " of " counter(pages);
                font-size: 9pt;
                color: #666;
            }
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            font-size: 10pt;
            line-height: 1.5;
            color: #333;
            margin: 0;
            padding: 0;
        }

        h1 {
            font-size: 20pt;
            margin: 0 0 0.25em 0;
            color: #111;
        }

        h2 {
            font-size: 14pt;
            margin: 1.5em 0 0.5em 0;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 0.25em;
        }

        .header {
            border-bottom: 2px solid #333;
            padding-bottom: 1em;
            margin-bottom: 1.5em;
        }

        .meta {
            font-size: 9pt;
            color: #666;
        }

        .meta-item {
            display: inline-block;
            margin-right: 1.5em;
        }

        .ticker {
            font-family: 'Courier New', monospace;
            background-color: #f5f5f5;
            padding: 0.1em 0.3em;
            border-radius: 3px;
            font-size: 9pt;
        }

        .status {
            display: inline-block;
            padding: 0.2em 0.6em;
            border-radius: 3px;
            font-size: 9pt;
            font-weight: 600;
        }

        .status-portfolio { background: #dcfce7; color: #166534; }
        .status-on_deck { background: #fef9c3; color: #854d0e; }
        .status-watchlist { background: #dbeafe; color: #1e40af; }
        .status-passed { background: #f3f4f6; color: #374151; }

        .thesis {
            background-color: #f9fafb;
            border-left: 3px solid #3b82f6;
            padding: 1em;
            margin: 1em 0;
        }

        .note {
            margin-bottom: 1.25em;
            page-break-inside: avoid;
        }

        .note-header {
            display: flex;
            align-items: baseline;
            gap: 0.5em;
            margin-bottom: 0.25em;
        }

        .note-title {
            font-weight: 600;
            font-size: 11pt;
            color: #111;
        }

        .note-type {
            font-size: 8pt;
            padding: 0.15em 0.5em;
            border-radius: 10px;
            color: white;
        }

        .note-content {
            color: #444;
            margin-left: 0.5em;
            padding-left: 0.75em;
            border-left: 2px solid #e5e7eb;
        }

        .note-meta {
            font-size: 8pt;
            color: #888;
            margin-top: 0.25em;
        }

        .bullet {
            display: inline-block;
            width: 5px;
            height: 5px;
            background: #9ca3af;
            border-radius: 50%;
            margin-right: 0.5em;
            vertical-align: middle;
        }

        .footer {
            margin-top: 2em;
            padding-top: 1em;
            border-top: 1px solid #ddd;
            font-size: 8pt;
            color: #888;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>{{ company.name }}</h1>
        <div class="meta">
            {% for ticker in company.tickers.all %}
            <span class="meta-item"><span class="ticker">{{ ticker.symbol }}</span></span>
            {% endfor %}

            <span class="meta-item">
                <span class="status status-{{ company.status }}">{{ company.get_status_display }}</span>
            </span>

            {% if company.sector %}
            <span class="meta-item">{{ company.get_sector_display }}</span>
            {% endif %}

            {% if company.country %}
            <span class="meta-item">{{ company.country }}</span>
            {% endif %}
        </div>
    </div>

    {% if company.description %}
    <div>
        <h2>Description</h2>
        <p>{{ company.description }}</p>
    </div>
    {% endif %}

    {% if company.thesis %}
    <div>
        <h2>Investment Thesis</h2>
        <div class="thesis">
            {{ company.thesis|linebreaks }}
        </div>
    </div>
    {% endif %}

    <h2>Research Notes ({{ notes.count }})</h2>

    {% for note in notes %}
    <div class="note">
        <div class="note-header">
            <span class="bullet"></span>
            <span class="note-title">{{ note.title }}</span>
            {% if note.note_type %}
            <span class="note-type" style="background-color: {{ note.note_type.color }}">
                {{ note.note_type.name }}
            </span>
            {% endif %}
        </div>

        {% if note.content %}
        <div class="note-content">
            {{ note.content|linebreaks }}
        </div>
        {% endif %}

        <div class="note-meta">
            {{ note.created_at|date:"M j, Y" }}
            {% if note.created_by %} by {{ note.created_by.get_full_name }}{% endif %}
            {% if note.note_date %} | Event: {{ note.note_date|date:"M j, Y" }}{% endif %}
        </div>
    </div>
    {% empty %}
    <p style="color: #666; font-style: italic;">No notes recorded yet.</p>
    {% endfor %}

    <div class="footer">
        Generated on {{ export_date|date:"F j, Y" }} | Bireme Research
    </div>
</body>
</html>
